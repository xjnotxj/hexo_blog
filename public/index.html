<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="小蒋不素小蒋">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="小蒋不素小蒋">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小蒋不素小蒋">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/"/>

  <title> 小蒋不素小蒋 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?ca9c79cc2c25ea90183640659d5e0d17";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">小蒋不素小蒋</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">点滴生活与技术</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'GzywR78iuG9Hcfx3PR-1','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/06/一台电脑上的 git 同时使用两个 github 账户/" itemprop="url">
                  一台电脑上的 git 同时使用两个 github 账户
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-09-06T14:12:00+08:00" content="2016-09-06">
              2016-09-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/06/一台电脑上的 git 同时使用两个 github 账户/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/06/一台电脑上的 git 同时使用两个 github 账户/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/09/06/一台电脑上的 git 同时使用两个 github 账户/" class="leancloud_visitors" data-flag-title="一台电脑上的 git 同时使用两个 github 账户">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h2><p>公司有 github 账号，自己有 github 账号，想在 git 上同时使用，两者互不干扰。</p>
<h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h2><p>管理两个 SHH key。</p>
<h2 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h2><h3 id="一、生成两个-SSH-key"><a href="#一、生成两个-SSH-key" class="headerlink" title="一、生成两个 SSH key"></a>一、生成两个 SSH key</h3><p>为了举例方便，这里使用“<strong>one</strong>”和“<strong>two</strong>”两个账户。下同。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ssh-keygen -t rsa -C &quot;one@gmail.com&quot;</div><div class="line"></div><div class="line">$ ssh-keygen -t rsa -C &quot;two@gmail.com&quot;</div></pre></td></tr></table></figure>
<p>不要一路回车，分别在第一个对话的时候输入重命名（ <strong>id_rsa_one</strong> 和 <strong>id_rsa_two</strong> ），这样会生成<img src="http://images2015.cnblogs.com/blog/896608/201609/896608-20160906141211848-1361958749.png" alt="">两份包含私钥和公钥的 4 个文件。</p>
<blockquote>
<ol>
<li>sh-keygen 是 linux命令，可以让两个机器之间使用 ssh 而不需要用户名和密码</li>
<li>一定要在 ~/.ssh 路径下运行命令行，不然生成的文件不会出现在当前目录</li>
</ol>
</blockquote>
<h3 id="二、添加私钥"><a href="#二、添加私钥" class="headerlink" title="二、添加私钥"></a>二、添加私钥</h3><h4 id="（1）打开-ssh-agent"><a href="#（1）打开-ssh-agent" class="headerlink" title="（1）打开 ssh-agent"></a>（1）打开 ssh-agent</h4><p>1.如果你是 github 官方的 bash：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh-agent -s</div></pre></td></tr></table></figure>
<p>2.如果你是其它，比如msysgit：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ eval $(ssh-agent -s)</div></pre></td></tr></table></figure></p>
<h4 id="（2）添加私钥"><a href="#（2）添加私钥" class="headerlink" title="（2）添加私钥"></a>（2）添加私钥</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ssh-add ~/.ssh/id_rsa_one</div><div class="line"></div><div class="line">$ ssh-add ~/.ssh/id_rsa_two</div></pre></td></tr></table></figure>
<h3 id="三、创建-config-文件"><a href="#三、创建-config-文件" class="headerlink" title="三、创建 config 文件"></a>三、创建 config 文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ touch config</div></pre></td></tr></table></figure>
<p>此时会出现空的 config 文件，然后添加如下内容：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"># one(one@gmail.com)</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">!-</span> <span class="attr">one.github.com</span> <span class="attr">--</span>&gt;</span></div><div class="line">    Host one.github.com</div><div class="line"></div><div class="line">　　HostName github.com</div><div class="line"></div><div class="line">　　PreferredAuthentications publickey</div><div class="line"></div><div class="line">　　IdentityFile ~/.ssh/id_rsa_one</div><div class="line"></div><div class="line">　　User one</div><div class="line"></div><div class="line"></div><div class="line"># two(two@ gmail.com)</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">!-</span> <span class="attr">two.github.com</span> <span class="attr">--</span>&gt;</span></div><div class="line">    Host two.github.com</div><div class="line"></div><div class="line">　　HostName github.com</div><div class="line"></div><div class="line">　　PreferredAuthentications publickey</div><div class="line"></div><div class="line">　　IdentityFile ~/.ssh/id_rsa_two</div><div class="line"></div><div class="line">　　User two</div></pre></td></tr></table></figure>
<h3 id="四、部署-SSH-key"><a href="#四、部署-SSH-key" class="headerlink" title="四、部署 SSH key"></a>四、部署 SSH key</h3><p>分别登陆两个 github 账号，进入 <strong>Personal settings –&gt; SSH and GPG keys</strong> ：</p>
<p><img src="http://images2015.cnblogs.com/blog/896608/201609/896608-20160906141212879-1996635009.png" alt=""><br>点击 “new SSH key”， 把下面两个公钥的内容分别添加到相应的 github 账号中。<br><img src="http://images2015.cnblogs.com/blog/896608/201609/896608-20160906141213363-1283878125.png" alt=""></p>
<h3 id="五、远程测试【可跳过】"><a href="#五、远程测试【可跳过】" class="headerlink" title="五、远程测试【可跳过】"></a>五、远程测试【可跳过】</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ssh –T one.github.com</div><div class="line"></div><div class="line">$ ssh –T two.github.com</div></pre></td></tr></table></figure>
<h3 id="六、使用"><a href="#六、使用" class="headerlink" title="六、使用"></a>六、使用</h3><h4 id="（1）clone-到本地"><a href="#（1）clone-到本地" class="headerlink" title="（1）clone 到本地"></a>（1）clone 到本地</h4><p>1.原来的写法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ git clone git@github.com: one 的用户名/learngit.git</div></pre></td></tr></table></figure></p>
<p>2.现在的写法：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">!-</span> <span class="attr">one.github.com</span> <span class="attr">--</span>&gt;</span></div><div class="line">$ git clone git@one.github.com: one 的用户名/learngit.git</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">!-</span> <span class="attr">two.github.com</span> <span class="attr">--</span>&gt;</span></div><div class="line">$ git clone git@two.github.com: two 的用户名/learngit.git</div></pre></td></tr></table></figure></p>
<h4 id="（2）记得给这个仓库设置局部的用户名和邮箱"><a href="#（2）记得给这个仓库设置局部的用户名和邮箱" class="headerlink" title="（2）记得给这个仓库设置局部的用户名和邮箱"></a>（2）记得给这个仓库设置局部的用户名和邮箱</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ git config user.name &quot;one_name&quot; ; git config user.email &quot;one_email&quot;</div><div class="line"></div><div class="line">$ git config user.name &quot;two_name&quot; ; git config user.email &quot;two_email&quot;</div></pre></td></tr></table></figure>
<h4 id="（3）上述都成功后，会发现钥匙会由灰变绿"><a href="#（3）上述都成功后，会发现钥匙会由灰变绿" class="headerlink" title="（3）上述都成功后，会发现钥匙会由灰变绿"></a>（3）上述都成功后，会发现钥匙会由灰变绿</h4><p><img src="http://images2015.cnblogs.com/blog/896608/201609/896608-20160906141214098-881485710.png" alt=""><br><img src="http://images2015.cnblogs.com/blog/896608/201609/896608-20160906141214426-402089066.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/11/移动端上传照片 预览+Draw on Canvas's Demo（解决 iOS 等设备照片旋转 90 度的 bug）/" itemprop="url">
                  移动端上传照片 预览 + Draw on Canvas's Demo（解决 iOS 等设备照片旋转 90 度的 bug）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-11T22:12:00+08:00" content="2016-06-11">
              2016-06-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/11/移动端上传照片 预览+Draw on Canvas's Demo（解决 iOS 等设备照片旋转 90 度的 bug）/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/11/移动端上传照片 预览+Draw on Canvas's Demo（解决 iOS 等设备照片旋转 90 度的 bug）/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/06/11/移动端上传照片 预览+Draw on Canvas's Demo（解决 iOS 等设备照片旋转 90 度的 bug）/" class="leancloud_visitors" data-flag-title="移动端上传照片 预览 + Draw on Canvas's Demo（解决 iOS 等设备照片旋转 90 度的 bug）">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>本人的一个移动端 H5 项目，需求如下:</p>
<blockquote>
<p><code>需求一</code>：手机相册选取或拍摄照片后在页面上<strong>预览</strong><br><code>需求二</code>：然后<strong>绘制在 canvas</strong> 画布上</p>
</blockquote>
<p>这里，我们先看一个 demo:<br><iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/83qfqpk8/embedded/html,css,result/light" frameborder="0" allowfullscreen></iframe></p>
<blockquote>
<p><code>需求一</code>： <code>drawTempPhoto</code> 方法<br><code>需求二</code>： <code>drawPhoto</code> 方法</p>
</blockquote>
<h3 id="操作步骤："><a href="#操作步骤：" class="headerlink" title="操作步骤："></a>操作步骤：</h3><p><img src="http://images2015.cnblogs.com/blog/896608/201606/896608-20160611221139058-105612097.png" alt=""><br>1.点击选择文件，拍摄一张照片，此时”预览：”文字下会显示你刚才拍摄的照片<br>2.再点击”draw on Canvas”，该按钮下的画布会绘制你刚才拍摄的照片</p>
<h3 id="正常的结果："><a href="#正常的结果：" class="headerlink" title="正常的结果："></a>正常的结果：</h3><p><img src="http://images2015.cnblogs.com/blog/896608/201606/896608-20160611221140824-608883375.png" alt=""></p>
<h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><h3 id="一、让-input-file-支持-拍照-相册-选取"><a href="#一、让-input-file-支持-拍照-相册-选取" class="headerlink" title="一、让 input file 支持 拍照 + 相册 选取"></a>一、让 input file 支持 <strong>拍照 + 相册</strong> 选取</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;input accept=<span class="string">"image/*"</span> type=<span class="string">"file"</span> id=<span class="string">"file"</span> /&gt;</div><div class="line"><span class="comment">//有一些特殊的安卓机还需要加上 capture="camera" 属性才能支持拍照</span></div></pre></td></tr></table></figure>
<h3 id="二、需求一的预览功能使用-html5-提供的新-API：FileReader"><a href="#二、需求一的预览功能使用-html5-提供的新-API：FileReader" class="headerlink" title="二、需求一的预览功能使用 html5 提供的新 API：FileReader"></a>二、<code>需求一</code>的<strong>预览</strong>功能使用 html5 提供的新 API：<strong>FileReader</strong></h3><blockquote>
<p>介绍：<br> FileReader 接口提供了一个异步 API，使用该 API 可以在浏览器主线程中异步访问文件系统，读取文件中的数据。</p>
<p> API 文档：<br> <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader</a></p>
<p> 兼容性：<br> 主流浏览器都支持。除了 IE 有点问题，详情看下图：<br><img src="http://images2015.cnblogs.com/blog/896608/201606/896608-20160611221142027-1855846622.png" alt=""></p>
</blockquote>
<h4 id="使用方法（使用-drawTempPhoto-方法实现需求一）："><a href="#使用方法（使用-drawTempPhoto-方法实现需求一）：" class="headerlink" title="使用方法（使用 drawTempPhoto 方法实现需求一）："></a>使用方法（使用 <code>drawTempPhoto</code> 方法实现<code>需求一</code>）：</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//绘制照片</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawTempPhoto</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//检验是否为图像文件</span></div><div class="line">    <span class="keyword">var</span> file = document.getElementById(<span class="string">"file"</span>).files[<span class="number">0</span>];</div><div class="line">    <span class="keyword">if</span> (!/image\/\w+/.test(file.type)) &#123;</div><div class="line">        alert(<span class="string">"看清楚哦，这个需要图片！"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</div><div class="line">    <span class="comment">//将文件以 Data URL 形式读入页面</span></div><div class="line">    reader.readAsDataURL(file);</div><div class="line">    reader.onload = <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">//预览效果</span></div><div class="line">        <span class="keyword">var</span> img = $(<span class="string">"#photo"</span>)[<span class="number">0</span>];</div><div class="line">        <span class="comment">//加载图片，此处的 this.result 为 base64 格式</span></div><div class="line">        img.src = this.result;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p><img src="http://images2015.cnblogs.com/blog/896608/201606/896608-20160611221143355-1662776781.png" alt=""><br>在本人的三星 note5 的手机中，<code>需求一</code>会出现照片预览逆时针旋转 90 度的 bug（其实用下面介绍的的 exif.js 方法，可以知道 iOS 和三星所拍的照片 Orientation 值都是 6，而前者做了预览的修正，后者则直接显示了出来，导致了旋转）。</p>
</blockquote>
<h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h4><p><strong><em>判断是否为三星手机设备，然后把预览的图片顺时针旋转 90 度恢复正常（例如可以用 canvas 技术模拟预览效果）。</em></strong></p>
<p>于是修改的 <code>drawTempPhoto</code> 方法如下【line：21-27】：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//绘制照片</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">drawTempPhoto</span><span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">//检验是否为图像文件</span></div><div class="line">        <span class="keyword">var</span> file = document.getElementById(<span class="string">"file"</span>).files[<span class="number">0</span>];</div><div class="line">        <span class="keyword">if</span> (!/image\/\w+/.test(file.type)) &#123;</div><div class="line">            alert(<span class="string">"看清楚哦，这个需要图片！"</span>);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</div><div class="line">        <span class="comment">//将文件以 Data URL 形式读入页面</span></div><div class="line">        reader.readAsDataURL(file);</div><div class="line">        reader.onload = <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> </span>&#123;</div><div class="line"></div><div class="line">            <span class="comment">//预览效果</span></div><div class="line">            <span class="keyword">var</span> img = $(<span class="string">"#photo"</span>)[<span class="number">0</span>];</div><div class="line">            <span class="comment">//加载图片，此处的 this.result 为 base64 格式</span></div><div class="line">            img.src = this.result;</div><div class="line">            img.onload = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">                <span class="comment">//获取照片的拍摄方向</span></div><div class="line">                <span class="keyword">var</span> orient = getPhotoOrientation(img);</div><div class="line">                alert(<span class="string">"orient1:"</span> + orient);</div><div class="line">                <span class="comment">//判断是否是三星手机</span></div><div class="line">　　          <span class="comment">// if (isSamsung) &#123;</span></div><div class="line">                      <span class="comment">// 做旋转的适配……</span></div><div class="line">                <span class="comment">// &#125;</span></div><div class="line"></div><div class="line">            &#125;;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="三、需求二绘制到-Canvas，使用-exif-js-解决-iOS（包括三星-note5）等一些手机照片旋转-90-度的-bug"><a href="#三、需求二绘制到-Canvas，使用-exif-js-解决-iOS（包括三星-note5）等一些手机照片旋转-90-度的-bug" class="headerlink" title="三、需求二绘制到 Canvas，使用 exif.js 解决 iOS（包括三星 note5）等一些手机照片旋转 90 度的 bug"></a>三、<code>需求二</code>绘制到 Canvas，使用 exif.js 解决 iOS（包括三星 note5）等一些手机照片旋转 90 度的 bug</h3><p>在 iOS 上，表现如下：<br><img src="http://images2015.cnblogs.com/blog/896608/201606/896608-20160611221144371-343240701.png" alt=""></p>
<p>可见，在 <strong>iOS</strong> 上第一张图正常，而第二张图<strong>逆时针旋转了 90 度</strong>，而其他的<strong>安卓</strong>两步都是<strong>正常的显示</strong>。</p>
<p>那我们来看看 <strong>exif.js</strong> 是什么？</p>
<blockquote>
<p>介绍：<br>Exif.js 提供了 JavaScript 读取图像的原始数据的功能扩展，例如：<strong>拍照方向</strong>、相机设备型号、拍摄时间、ISO 感光度、GPS 地理位置等数据。</p>
<p>兼容性：<br>EXIF 数据主要来自拍摄的照片，多用于移动端开发，PC 端也会用到，此插件兼容主流浏览器，IE10 以下不支持。</p>
<p>下载地址：<br><a href="https://github.com/exif-js/exif-js" target="_blank" rel="external">https://github.com/exif-js/exif-js</a></p>
</blockquote>
<p>这里我们知道了 exif.js 其实是获取一张拍摄照片的元信息的，进而获取它最初的拍照方向，这很可能跟 iOS 图片旋转的 bug 有关。</p>
<p>而 exif.js 提供的一张照片的 <strong>Orientation</strong> 属性如下：<br><img src="http://images2015.cnblogs.com/blog/896608/201606/896608-20160611221145371-963458118.gif" alt=""></p>
<h4 id="使用方法："><a href="#使用方法：" class="headerlink" title="使用方法："></a>使用方法：</h4><p>1.我首先引入 <code>exif.js</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script src=<span class="string">"./js/exif.js"</span>&gt;&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>2.然后封装成 <code>getPhotoOrientation</code> 方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//获取照片的元信息（拍摄方向）</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPhotoOrientation</span><span class="params">(img)</span></span>&#123;</div><div class="line">  <span class="keyword">var</span> orient;</div><div class="line">  EXIF.getData(img, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">      orient = EXIF.getTag(this, <span class="string">'Orientation'</span>);</div><div class="line">  &#125;);</div><div class="line">  <span class="keyword">return</span> orient;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3.分别在操作步骤一选择图片和操作步骤二 draw on Canvas，Alert 照片的 Orientation 值，本人的测试机有限，请见谅，结果如下：</p>
<table>
<thead>
<tr>
<th>手机型号</th>
<th>Orientation值</th>
</tr>
</thead>
<tbody>
<tr>
<td>iphone 6S</td>
<td><strong>6</strong></td>
</tr>
<tr>
<td>小米4S</td>
<td>undefined</td>
</tr>
<tr>
<td>华为荣耀4A</td>
<td>1</td>
</tr>
<tr>
<td>PC</td>
<td>undefined</td>
</tr>
</tbody>
</table>
<p>可以看到，小米 4S 和 PC 都是 undefined，表示图片没有拍摄方向或者根本没记录，华为荣耀 4A 是 1，表示的是正确的方向，以上都没问题。但 iphone 6S 为 6！<strong>所以之所以出现了图片的旋转，是因为它本身的 Orientation 就不正常！！</strong></p>
<p><strong><em>因此解决这个 bug 的思路是：获取到照片拍摄的方向，对 ios 照片进行角度旋转修正。</em></strong></p>
<h4 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h4><p>修改后的 demo:<br><iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/k3z5ev26/embedded/javascript,html,css,result/light" frameborder="0" allowfullscreen></iframe></p>
<p>除了上面引入的 <code>exif.js</code> 和添加的 <code>getPhotoOrientation</code> 方法，我又修改了 <code>drawPhoto</code> 方法：</p>
<p>1.旧 <code>drawPhoto</code> 方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//绘制照片</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawPhoto</span><span class="params">(photo, x, y, w, h)</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> canvas = document.getElementById(<span class="string">"canvas"</span>);</div><div class="line">    <span class="keyword">if</span> (canvas.getContext) &#123;</div><div class="line">        <span class="keyword">var</span> ctx = canvas.getContext(<span class="string">"2d"</span>);</div><div class="line"></div><div class="line">        <span class="comment">//draw on Canvas</span></div><div class="line">        <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</div><div class="line">        img.onload = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">            <span class="keyword">var</span> canvas_w = Number(ctx.canvas.width);</div><div class="line">            <span class="keyword">var</span> canvas_h = Number(ctx.canvas.height);</div><div class="line"></div><div class="line">            <span class="comment">// 执行 Canvas 的 drawImage 语句</span></div><div class="line">            ctx.drawImage(img, x, y, w, h);</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        img.src = photo.src; <span class="comment">// 设置图片源地址</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2.新 <code>drawPhoto</code> 方法【line：4-6，19-30】：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//绘制照片</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawPhoto</span><span class="params">(photo, x, y, w, h)</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">//获取照片的拍摄方向</span></div><div class="line">    <span class="keyword">var</span> orient = getPhotoOrientation(photo);</div><div class="line">    alert(<span class="string">"orient2:"</span>+orient);</div><div class="line"></div><div class="line">    <span class="keyword">var</span> canvas = document.getElementById(<span class="string">"canvas"</span>);</div><div class="line">    <span class="keyword">if</span> (canvas.getContext) &#123;</div><div class="line">        <span class="keyword">var</span> ctx = canvas.getContext(<span class="string">"2d"</span>);</div><div class="line"></div><div class="line">        <span class="comment">//draw on Canvas</span></div><div class="line">        <span class="keyword">var</span> img = <span class="keyword">new</span> Image();</div><div class="line">        img.onload = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line"></div><div class="line">            <span class="keyword">var</span> canvas_w = Number(ctx.canvas.width);</div><div class="line">            <span class="keyword">var</span> canvas_h = Number(ctx.canvas.height);</div><div class="line"></div><div class="line">            <span class="comment">//判断图片拍摄方向是否旋转了 90 度</span></div><div class="line">            <span class="keyword">if</span> (orient == <span class="number">6</span>) &#123;</div><div class="line">                ctx.save();<span class="comment">//保存状态</span></div><div class="line">                ctx.translate(canvas_w / <span class="number">2</span>, canvas_h / <span class="number">2</span>);<span class="comment">//设置画布上的(0,0)位置，也就是旋转的中心点</span></div><div class="line">                ctx.rotate(<span class="number">90</span> * Math.PI / <span class="number">180</span>);<span class="comment">//把画布旋转 90 度</span></div><div class="line">                <span class="comment">// 执行 Canvas 的 drawImage 语句</span></div><div class="line">                ctx.drawImage(img, Number(y) - canvas_h / <span class="number">2</span>, Number(x) - canvas_w / <span class="number">2</span>, h, w);<span class="comment">//把图片绘制在画布 translate 之前的中心点，</span></div><div class="line">                ctx.restore();<span class="comment">//恢复状态</span></div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">// 执行 Canvas 的 drawImage 语句</span></div><div class="line">                ctx.drawImage(img, x, y, w, h);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        img.src = photo.src; <span class="comment">// 设置图片源地址</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>运行结果如下：<br><img src="http://images2015.cnblogs.com/blog/896608/201606/896608-20160611221147277-517861637.png" alt=""></p>
<p>完美~</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/11/移动端禁止页面下滑/" itemprop="url">
                  移动端禁止页面下滑
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-11T01:01:00+08:00" content="2016-06-11">
              2016-06-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/11/移动端禁止页面下滑/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/11/移动端禁止页面下滑/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/06/11/移动端禁止页面下滑/" class="leancloud_visitors" data-flag-title="移动端禁止页面下滑">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>本人开发移动端 H5 时，想让页面禁止向下滑动，最初的代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">html,body&#123;</div><div class="line">    overflow: hidden;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在 Chrome 移动端调试工具中可以，但是用 iPhone 的微信打开，<strong>失效</strong>了。</p>
<h2 id="解决："><a href="#解决：" class="headerlink" title="解决："></a>解决：</h2><h4 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">html,body&#123;</div><div class="line">    position:fixed;</div><div class="line">    overflow-y:hidden;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">html,body&#123;</div><div class="line">    overflow: hidden;</div><div class="line">    width: 100%;</div><div class="line">    height:100%;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h4 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h4><p><a href="https://www.zhihu.com/question/23327222" target="_blank" rel="external">移动端如何禁用横向滚动条? - 前端开发 - 知乎</a> </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/10/移动端用 js 与 jquery 实时监听输入框值的改动/" itemprop="url">
                  移动端用 js 与 jquery 实时监听输入框值的改动
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-10T22:01:00+08:00" content="2016-06-10">
              2016-06-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/10/移动端用 js 与 jquery 实时监听输入框值的改动/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/10/移动端用 js 与 jquery 实时监听输入框值的改动/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/06/10/移动端用 js 与 jquery 实时监听输入框值的改动/" class="leancloud_visitors" data-flag-title="移动端用 js 与 jquery 实时监听输入框值的改动">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>在一次移动端 H5 开发中，需要监听输入框值的实时变动。</p>
<p>onchange 事件肯定抛弃，因为只能失去焦点才触发。</p>
<p>而 keyPress 在 Android 可以触发，iOS 不可以。</p>
<p>又不想用 Android 和 iOS 都可以触发的 keyDown 和 keyUp。</p>
<p>于是，百度出了新东西：<strong>oninput</strong>！【需要配合 <strong>propertychange</strong>，兼容 IE9 以下版本】</p>
<h2 id="用法"><a href="#用法" class="headerlink" title="用法:"></a>用法:</h2><h4 id="JS"><a href="#JS" class="headerlink" title="JS:"></a>JS:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">if(isIE) </div><div class="line">&#123; </div><div class="line">　　document.getElementById(&quot;input&quot;).onpropertychange = keys(); </div><div class="line">&#125; </div><div class="line">else </div><div class="line">&#123; </div><div class="line">　　document.getElementById(&quot;input&quot;).addEventListener(&quot;input&quot;, keys, false);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="jQuery："><a href="#jQuery：" class="headerlink" title="jQuery："></a>jQuery：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;!- input propertychange --&gt;</div><div class="line">$(&apos;input&apos;).bind(&apos;input propertychange&apos;, function() &#123; </div><div class="line">　　//进行相关操作 </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<blockquote>
<p>下面的写法<strong>不支持</strong>：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">!-</span> <span class="attr">N</span>/<span class="attr">A</span> <span class="attr">--</span>&gt;</span></div><div class="line">$('input').input(function() &#123;</div><div class="line">　　//进行相关操作 </div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
</blockquote>
<hr>
<h4 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h4><p><a href="http://www.jb51.net/article/60789.htm" target="_blank" rel="external"> js与jquery实时监听输入框值的oninput与onpropertychange方法</a> </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/10/从重置 input file 标签中看 jQuery 的  .val() 和 .attr(“value”) 区别/" itemprop="url">
                  从重置 input file 标签中看 jQuery 的  .val() 和 .attr(“value”) 区别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-10T21:28:00+08:00" content="2016-06-10">
              2016-06-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/10/从重置 input file 标签中看 jQuery 的  .val() 和 .attr(“value”) 区别/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/10/从重置 input file 标签中看 jQuery 的  .val() 和 .attr(“value”) 区别/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/06/10/从重置 input file 标签中看 jQuery 的  .val() 和 .attr(“value”) 区别/" class="leancloud_visitors" data-flag-title="从重置 input file 标签中看 jQuery 的  .val() 和 .attr(“value”) 区别">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>在<strong>清空 input file 标签选中值</strong>时，分别用了以下方法，发现有的对有的错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">【√】$(&quot;#file&quot;)[0].value = &quot;&quot;;</div><div class="line">【√】$(&quot;#file&quot;)[0].value = null;</div><div class="line"></div><div class="line">【×】$(&quot;#file&quot;).attr(&quot;value&quot;,&quot;&quot;);</div><div class="line">【×】$(&quot;#file&quot;).attr(&quot;value&quot;,null);</div><div class="line"></div><div class="line">【√】$(&quot;#file&quot;).val(&quot;&quot;);</div><div class="line">【√】$(&quot;#file&quot;).val(null);</div></pre></td></tr></table></figure>
<p>为什么同样是改变 value 值，得到的结果却不同呢？</p>
<h2 id="释疑："><a href="#释疑：" class="headerlink" title="释疑："></a>释疑：</h2><p>阅 stackoverflow《jQuery .val() vs .attr(“value”)》Question，里面解答如下：</p>
<blockquote>
<p>The gist is that .attr(…) is only getting the objects value at the start (when the html is created). val() is getting the object’s property value which can change many times.</p>
</blockquote>
<p>翻译过来就是：</p>
<blockquote>
<p>.val() 设置的是 input 的 value 属性，input 是 HTMLInputElement 的实例，value 是通过 setter 方法定义的，当被赋值时，就会把值写到 input 里面；而改变 value 属性的方法，实际上操作的是 dom 的 value 属性，会触发浏览器的 repaint，更新 input 的值。</p>
</blockquote>
<hr>
<h4 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h4><p><a href="http://stackoverflow.com/questions/8312820/jquery-val-vs-attrvalue" target="_blank" rel="external"> forms - jQuery .val() vs .attr(“value”) - Stack Overflow </a> </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/08/Web 中的触摸（touch）与手势（gesture）事件/" itemprop="url">
                  Web 中的触摸（touch）与手势（gesture）事件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-08T17:46:00+08:00" content="2016-06-08">
              2016-06-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/08/Web 中的触摸（touch）与手势（gesture）事件/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/08/Web 中的触摸（touch）与手势（gesture）事件/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/06/08/Web 中的触摸（touch）与手势（gesture）事件/" class="leancloud_visitors" data-flag-title="Web 中的触摸（touch）与手势（gesture）事件">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一-触摸事件（TouchEvent）"><a href="#一-触摸事件（TouchEvent）" class="headerlink" title="一.触摸事件（TouchEvent）"></a>一.触摸事件（TouchEvent）</h2><h4 id="事件："><a href="#事件：" class="headerlink" title="事件："></a>事件：</h4><ul>
<li><p><strong>touchstart</strong> : 当手指触摸屏幕时触发；即使已经有一个手指放在了屏幕上也会触发</p>
</li>
<li><p><strong>touchmove</strong> : 当手指在屏幕上滑动时连续的触发。调用 preventDefault() 可阻止滚动</p>
</li>
<li><p><strong>touchend</strong> : 当手指从屏幕上移开时触发</p>
</li>
<li><p><strong>touchcancel</strong> : 当系统停止跟踪触摸时触发。关于此事件的确切触发事件，文档中没有明确说明</p>
</li>
</ul>
<h4 id="事件属性："><a href="#事件属性：" class="headerlink" title="事件属性："></a>事件属性：</h4><ul>
<li><p>e.<strong>touches</strong> : 当前屏幕上所有触摸点的集合列表</p>
</li>
<li><p>e.<strong>targetTouches</strong> : 绑定事件的那个结点上的触摸点的集合列表</p>
</li>
<li><p>e.<strong>changedTouches</strong> : 触发事件时改变的触摸点的集合</p>
</li>
</ul>
<p>事件属性返回<strong>数组</strong>的每个 Touch 对象包含下列属性：</p>
<ul>
<li><p>clientX : 触摸目标在视口中的 X 坐标。</p>
</li>
<li><p>clientY : 触摸目标在视口中的 Y 坐标。</p>
</li>
<li><p>identifier : 表示触摸的唯一 ID。</p>
</li>
<li><p>pageX : 触摸目标在页面中的 x 坐标。</p>
</li>
<li><p>pageY : 触摸目标在页面中的 y 坐标。</p>
</li>
<li><p>screenX : 触摸目标在屏幕中的 x 坐标。</p>
</li>
<li><p>screenY : 触摸目标在屏幕中的 y 坐标。</p>
</li>
<li><p>target : 触摸的 DOM 节点坐标。 </p>
</li>
</ul>
<h4 id="例1-单个手指-touch"><a href="#例1-单个手指-touch" class="headerlink" title="例1.单个手指 touch"></a>例1.<strong>单</strong>个手指 touch</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=<span class="string">"en"</span>&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</div><div class="line">    &lt;meta content=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"</span> name=<span class="string">"viewport"</span>&gt;</div><div class="line">    &lt;title&gt;single figure touch test&lt;/title&gt;</div><div class="line">    &lt;style type=<span class="string">"text/css"</span>&gt;</div><div class="line">        html, body &#123;</div><div class="line">            height: <span class="number">100</span>%;</div><div class="line">            width: <span class="number">100</span>%;</div><div class="line">            margin: <span class="number">0</span>;</div><div class="line">            padding: <span class="number">0</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">#canvas &#123;</span></div><div class="line">            position: relative;</div><div class="line">            width: <span class="number">100</span>%;</div><div class="line">            height: <span class="number">100</span>%;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        .spirit &#123; <span class="comment">/* 方块的class名称*/</span></div><div class="line">            position: absolute;</div><div class="line">            width: <span class="number">50</span>px;</div><div class="line">            height: <span class="number">50</span>px;</div><div class="line">            background-color: red;</div><div class="line">        &#125;</div><div class="line">    &lt;/style&gt;</div><div class="line">&lt;/head&gt;</div><div class="line"></div><div class="line">&lt;body&gt;</div><div class="line"></div><div class="line">&lt;div id=<span class="string">"canvas"</span>&gt;&lt;/div&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"></div><div class="line">    <span class="comment">// define global variable</span></div><div class="line">    <span class="keyword">var</span> canvas = document.getElementById(<span class="string">"canvas"</span>),</div><div class="line">            spirit, startX, startY;</div><div class="line"></div><div class="line">    <span class="comment">// touch start listener</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">touchStart</span><span class="params">(event)</span> </span>&#123;</div><div class="line">        <span class="comment">//防止手指的操作引起页面滑动</span></div><div class="line">        event.preventDefault();</div><div class="line">        <span class="keyword">if</span> (spirit || !event.touches.length) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">var</span> touch = event.touches[<span class="number">0</span>];</div><div class="line">        startX = touch.pageX;</div><div class="line">        startY = touch.pageY;</div><div class="line">        spirit = document.createElement(<span class="string">"div"</span>);</div><div class="line">        spirit.className = <span class="string">"spirit"</span>;</div><div class="line">        <span class="comment">//注意：一定要加‘px’单位</span></div><div class="line">        spirit.style.left = startX + <span class="string">'px'</span>;</div><div class="line">        spirit.style.top = startY + <span class="string">'px'</span>;</div><div class="line">        canvas.appendChild(spirit);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// add touch start listener</span></div><div class="line">    canvas.addEventListener(<span class="string">"touchstart"</span>, touchStart, <span class="keyword">false</span>);</div><div class="line"></div><div class="line">    <span class="comment">// touch move listener</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">touchMove</span><span class="params">(event)</span> </span>&#123;</div><div class="line">        <span class="comment">//防止手指的操作引起页面滑动</span></div><div class="line">        event.preventDefault();</div><div class="line">        <span class="keyword">if</span> (!spirit || !event.touches.length) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">var</span> touch = event.touches[<span class="number">0</span>],</div><div class="line">                x = touch.pageX - startX,</div><div class="line">                y = touch.pageY - startY;</div><div class="line">        spirit.style.webkitTransform = <span class="string">'translate('</span> + x + <span class="string">'px, '</span> + y + <span class="string">'px)'</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// touch move listener</span></div><div class="line">    canvas.addEventListener(<span class="string">"touchmove"</span>, touchMove, <span class="keyword">false</span>);</div><div class="line"></div><div class="line">    <span class="comment">// touch end listener</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">touchEnd</span><span class="params">(event)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!spirit) <span class="keyword">return</span>;</div><div class="line">        canvas.removeChild(spirit);</div><div class="line">        spirit = <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// touch end listener</span></div><div class="line">    canvas.addEventListener(<span class="string">"touchend"</span>, touchEnd, <span class="keyword">false</span>);</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<h4 id="例2-多个手指-touch"><a href="#例2-多个手指-touch" class="headerlink" title="例2.多个手指 touch"></a>例2.<strong>多</strong>个手指 touch</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=<span class="string">"en"</span>&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</div><div class="line">    &lt;meta content=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"</span> name=<span class="string">"viewport"</span>&gt;</div><div class="line">    &lt;title&gt;multi figure touch test&lt;/title&gt;</div><div class="line">    &lt;style type=<span class="string">"text/css"</span>&gt;</div><div class="line">        html, body &#123;</div><div class="line">            margin: <span class="number">0</span>;</div><div class="line">            padding: <span class="number">0</span>;</div><div class="line">            height: <span class="number">100</span>%;</div><div class="line">            width: <span class="number">100</span>%;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">#canvas &#123;</span></div><div class="line">            width: <span class="number">100</span>%;</div><div class="line">            height: <span class="number">100</span>%;</div><div class="line">            position: relative;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        .spirit &#123;</div><div class="line">            position: absolute;</div><div class="line">            width: <span class="number">70</span>px;</div><div class="line">            height: <span class="number">70</span>px;</div><div class="line">        &#125;</div><div class="line">    &lt;/style&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;div id=<span class="string">"canvas"</span>&gt;&lt;/div&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</div><div class="line">    <span class="keyword">var</span> canvas = document.getElementById(<span class="string">"canvas"</span>),</div><div class="line">            stacks = [&#123;</div><div class="line">                color: <span class="string">"red"</span></div><div class="line">            &#125;, &#123;</div><div class="line">                color: <span class="string">"blue"</span></div><div class="line">            &#125;, &#123;</div><div class="line">                color: <span class="string">"green"</span></div><div class="line">            &#125;, &#123;</div><div class="line">                color: <span class="string">"black"</span></div><div class="line">            &#125;, &#123;</div><div class="line">                color: <span class="string">"yellow"</span></div><div class="line">            &#125;, &#123;</div><div class="line">                color: <span class="string">"orange"</span></div><div class="line">            &#125;];</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getEmptyStack</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>, s, l = stacks.length;</div><div class="line">        <span class="keyword">for</span> (; i &lt; l; i++) &#123;</div><div class="line">            s = stacks[i];</div><div class="line">            <span class="keyword">if</span> (!s.touchId)</div><div class="line">                <span class="keyword">return</span> s;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getStackByTouchId</span><span class="params">(touchId)</span> </span>&#123;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">0</span>, s, l = stacks.length;</div><div class="line">        <span class="keyword">for</span> (; i &lt; l; i++) &#123;</div><div class="line">            s = stacks[i];</div><div class="line">            <span class="keyword">if</span> (s.touchId == touchId)</div><div class="line">                <span class="keyword">return</span> s;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">touchStart</span><span class="params">(e)</span> </span>&#123;</div><div class="line">        e.preventDefault();</div><div class="line">        <span class="keyword">var</span> touches = e.changedTouches,</div><div class="line">                i = <span class="number">0</span>, l = touches.length, touch, stack;</div><div class="line">        <span class="keyword">for</span> (; i &lt; l; i++) &#123;</div><div class="line">            touch = touches[i];</div><div class="line">            stack = getStackByTouchId(touch.identifier);</div><div class="line">            <span class="keyword">if</span> (stack) <span class="keyword">return</span>;</div><div class="line">            stack = getEmptyStack();</div><div class="line">            <span class="keyword">if</span> (stack) &#123;</div><div class="line">                stack.touchId = touch.identifier;</div><div class="line">                stack.spirit = document.createElement(<span class="string">"div"</span>);</div><div class="line">                stack.spirit.className = <span class="string">"spirit"</span>;</div><div class="line">                stack.startX = touch.pageX;</div><div class="line">                stack.startY = touch.pageY;</div><div class="line">                stack.spirit.style.left = touch.pageX + <span class="string">"px"</span>;</div><div class="line">                stack.spirit.style.top = touch.pageY + <span class="string">"px"</span>;</div><div class="line">                stack.spirit.style.backgroundColor = stack.color;</div><div class="line">                canvas.appendChild(stack.spirit);</div><div class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// stack list is full</span></div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">touchMove</span><span class="params">(e)</span> </span>&#123;</div><div class="line">        e.preventDefault();</div><div class="line">        <span class="keyword">var</span> touches = e.targetTouches,</div><div class="line">                i = <span class="number">0</span>, l = touches.length, touch, stack;</div><div class="line">        <span class="keyword">for</span> (; i &lt; l; i++) &#123;</div><div class="line">            touch = touches[i];</div><div class="line">            stack = getStackByTouchId(touch.identifier);</div><div class="line">            <span class="keyword">if</span> (stack) &#123;</div><div class="line">                <span class="keyword">var</span> x = touch.pageX - stack.startX,</div><div class="line">                        y = touch.pageY - stack.startY,</div><div class="line">                        spirit = stack.spirit;</div><div class="line">                spirit.style.webkitTransform = <span class="string">'translate('</span> + x + <span class="string">'px, '</span> + y + <span class="string">'px)'</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">touchEnd</span><span class="params">(e)</span> </span>&#123;</div><div class="line">        <span class="keyword">var</span> touches = e.changedTouches,</div><div class="line">                i = <span class="number">0</span>, l = touches.length, touch, stack;</div><div class="line">        <span class="keyword">for</span> (; i &lt; l; i++) &#123;</div><div class="line">            touch = touches[i];</div><div class="line">            stack = getStackByTouchId(touch.identifier);</div><div class="line">            <span class="keyword">if</span> (stack) &#123;</div><div class="line">                stack.touchId = <span class="keyword">null</span>;</div><div class="line">                canvas.removeChild(stack.spirit);</div><div class="line">                stack.spirit = <span class="keyword">null</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//当触控被中断</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">touchCancel</span><span class="params">(e)</span> </span>&#123;</div><div class="line">        <span class="keyword">var</span> touches = e.changedTouches,</div><div class="line">                i = <span class="number">0</span>, l = touches.length, touch, stack;</div><div class="line">        <span class="keyword">for</span> (; i &lt; l; i++) &#123;</div><div class="line">            touch = touches[i];</div><div class="line">            stack = getStackByTouchId(touch.identifier);</div><div class="line">            <span class="keyword">if</span> (stack) &#123;</div><div class="line">                stack.touchId = <span class="keyword">null</span>;</div><div class="line">                canvas.removeChild(stack.spirit);</div><div class="line">                stack.spirit = <span class="keyword">null</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    canvas.addEventListener(<span class="string">"touchstart"</span>, touchStart, <span class="keyword">false</span>);</div><div class="line">    canvas.addEventListener(<span class="string">"touchmove"</span>, touchMove, <span class="keyword">false</span>);</div><div class="line">    canvas.addEventListener(<span class="string">"touchend"</span>, touchEnd, <span class="keyword">false</span>);</div><div class="line">    canvas.addEventListener(<span class="string">"touchCancel"</span>, touchCancel, <span class="keyword">false</span>);</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<h4 id="例3-单个手指放下并滑动"><a href="#例3-单个手指放下并滑动" class="headerlink" title="例3.单个手指放下并滑动"></a>例3.<strong>单</strong>个手指放下并滑动</h4><p>1.手指滑动时，整个 page 会跟着移动，除非 <strong>preventDefault</strong> 了 body 的 touchmove<br>2.当手指停下来后， body 的 <strong>onscroll</strong> 将会触发</p>
<h2 id="二-手势事件（GestureEvent）"><a href="#二-手势事件（GestureEvent）" class="headerlink" title="二.手势事件（GestureEvent）"></a>二.手势事件（GestureEvent）</h2><p><strong>GestureEvent</strong> 包含手指点击（click），轻拂（flick），双击（double-click），两只手指的分开/闭合（scale）、转动（rotate），手指分开比例（scale）和手指转动角度（rotation）信息。</p>
<h4 id="事件：-1"><a href="#事件：-1" class="headerlink" title="事件："></a>事件：</h4><ul>
<li><strong>esturestart</strong> : 当有两根或多根手指放到屏幕上的时候触发</li>
<li><strong>gesturechange</strong> : 当有两根或多根手指在屏幕上，并且有手指移动的时候触发</li>
<li><strong>gestureend</strong> : 当倒数第二根手指提起的时候触发，结束gesture</li>
</ul>
<h4 id="事件属性：-1"><a href="#事件属性：-1" class="headerlink" title="事件属性："></a>事件属性：</h4><ul>
<li>e.<strong>rotation</strong> : 两只手指的转动</li>
<li>e.<strong>scale</strong> : 两只手指的分开/闭合</li>
</ul>
<h4 id="例1-依次放下两根手指"><a href="#例1-依次放下两根手指" class="headerlink" title="例1.依次放下两根手指"></a>例1.依次放下两根手指</h4><p>1.第一根手指放下，触发 touchstart<br>2.第二根手指放下，触发 gesturestart<br>3.触发第二根手指的 touchstart<br>4.立即触发 gesturechange<br>5.手指移动，持续触发 gesturechange<br>6.第二根手指提起，触发 gestureend<br>7.触发第二根手指的 touchend<br><strong>8.触发 touchstart ！注意，多根手指在屏幕上，提起一根，会刷新一次全局 touch！重新触发第一根手指的 touchstart</strong><br>9.提起第一根手指，触发 touchend </p>
<h4 id="例2-让-element-随着你的两根手指运动而转动"><a href="#例2-让-element-随着你的两根手指运动而转动" class="headerlink" title="例2.让 element 随着你的两根手指运动而转动"></a>例2.让 element 随着你的两根手指运动而转动</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">e.target.style.webkitTransform = &apos;scale(&apos; + e.scale + startScale + &apos;) rotate(&apos; + e.rotation + startRotation + &apos;deg)&apos;;</div></pre></td></tr></table></figure>
<hr>
<h4 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h4><ul>
<li><a href="http://www.cnblogs.com/pifoo/archive/2011/05/23/webkit-touch-event-1.html" target="_blank" rel="external">指尖下的 js ——多触式 web 前端开发之一：对于 Touch 的处理</a> </li>
<li><a href="https://www.w3cmm.com/javascript/touch.html" target="_blank" rel="external">触摸与手势事件</a> </li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/01/让 jQuery UI draggable 适配移动端/" itemprop="url">
                  让 jQuery UI draggable 适配移动端
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-01T23:46:00+08:00" content="2016-06-01">
              2016-06-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/01/让 jQuery UI draggable 适配移动端/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/01/让 jQuery UI draggable 适配移动端/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/06/01/让 jQuery UI draggable 适配移动端/" class="leancloud_visitors" data-flag-title="让 jQuery UI draggable 适配移动端">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>在移动端，本人要实现对某个元素的拖动，想到使用 jQuery UI 的 draggable 功能。但是发现此插件的拖动<strong>只支持 PC 端，不支持移动端</strong>。</p>
<h2 id="原因："><a href="#原因：" class="headerlink" title="原因："></a>原因：</h2><p>原始的 jQuery UI 里，都是 <strong>mousedown、mousemove、mouseup</strong> 来描述拖拽和<strong>鼠标</strong>的点击事件，而在移动端里，肯定要新添 <strong>touchstart、touchmove、touchend</strong> 来描述拖拽和<strong>手指</strong>的点击事件。</p>
<h2 id="实现demo："><a href="#实现demo：" class="headerlink" title="实现demo："></a>实现demo：</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"</span> <span class="attr">name</span>=<span class="string">"viewport"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>jQuery UI draggable 适配移动端<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"img"</span> <span class="attr">src</span>=<span class="string">"http://placehold.it/200x100"</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//cdn.bootcss.com/jquery/3.0.0-beta1/jquery.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//cdn.bootcss.com/jqueryui/1.11.4/jquery-ui.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="xml"></span></div><div class="line"></div><div class="line">    // jQuery UI draggable 适配移动端</div><div class="line"></div><div class="line">    var moveFlag = 0; // 是否移动的flag</div><div class="line">    // /iPad|iPhone|Android/.test( navigator.userAgent ) &amp;&amp;</div><div class="line">    (function ($) &#123;</div><div class="line">        var proto = $.ui.mouse.prototype, _mouseInit = proto._mouseInit;</div><div class="line">        $.extend(proto, &#123;</div><div class="line">            _mouseInit: function () &#123;</div><div class="line">                this.element.bind("touchstart." + this.widgetName, $.proxy(this, "_touchStart"));</div><div class="line">                _mouseInit.apply(this, arguments);</div><div class="line">            &#125;, _touchStart: function (event) &#123;</div><div class="line">                this.element.bind("touchmove." + this.widgetName, $.proxy(this, "_touchMove")).bind("touchend." + this.widgetName, $.proxy(this, "_touchEnd"));</div><div class="line">                this._modifyEvent(event);</div><div class="line">                $(document).trigger($.Event("mouseup"));</div><div class="line">                //reset mouseHandled flag in ui.mouse</div><div class="line">                this._mouseDown(event);</div><div class="line">                //console.log(this);</div><div class="line">                //return false;</div><div class="line"></div><div class="line">                <span class="tag">&lt;<span class="name">!-</span> <span class="attr">touchStart</span> <span class="attr">do</span> <span class="attr">something</span> <span class="attr">--</span>&gt;</span></div><div class="line">                console.log("i touchStart!");</div><div class="line"></div><div class="line">            &#125;, _touchMove: function (event) &#123;</div><div class="line">                moveFlag = 1;</div><div class="line">                this._modifyEvent(event);</div><div class="line">                this._mouseMove(event);</div><div class="line"></div><div class="line">                <span class="tag">&lt;<span class="name">!-</span> <span class="attr">touchMove</span> <span class="attr">do</span> <span class="attr">something</span> <span class="attr">--</span>&gt;</span></div><div class="line">                console.log("i touchMove!");</div><div class="line"></div><div class="line">            &#125;, _touchEnd: function (event) &#123;</div><div class="line">                // 主动触发点击事件</div><div class="line">                if (moveFlag == 0) &#123;</div><div class="line">                    var evt = document.createEvent('Event');</div><div class="line">                    evt.initEvent('click', true, true);</div><div class="line">                    this.handleElement[0].dispatchEvent(evt);</div><div class="line">                &#125;</div><div class="line">                this.element.unbind("touchmove." + this.widgetName).unbind("touchend." + this.widgetName);</div><div class="line">                this._mouseUp(event);</div><div class="line">                moveFlag = 0;</div><div class="line"></div><div class="line">                <span class="tag">&lt;<span class="name">!-</span> <span class="attr">touchEnd</span> <span class="attr">do</span> <span class="attr">something</span> <span class="attr">--</span>&gt;</span></div><div class="line">                console.log("i touchEnd!");</div><div class="line"></div><div class="line">            &#125;, _modifyEvent: function (event) &#123;</div><div class="line">                event.which = 1;</div><div class="line">                var target = event.originalEvent.targetTouches[0];</div><div class="line">                event.pageX = target.clientX;</div><div class="line">                event.pageY = target.clientY;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;)(jQuery);</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line">    // my js</div><div class="line">    $("#img").draggable();</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p><img src="http://images2015.cnblogs.com/blog/896608/201606/896608-20160601233350492-1691798716.png" alt=""></p>
<hr>
<h4 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h4><p><a href="http://www.ithao123.cn/content-766716.html" target="_blank" rel="external"> jQuery Ui Draggable 在移动端浏览器不起作用解决方案</a> </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/01/BrowserSync - 浏览器同步测试工具/" itemprop="url">
                  BrowserSync - 浏览器同步测试工具
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-01T22:46:00+08:00" content="2016-06-01">
              2016-06-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/01/BrowserSync - 浏览器同步测试工具/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/01/BrowserSync - 浏览器同步测试工具/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/06/01/BrowserSync - 浏览器同步测试工具/" class="leancloud_visitors" data-flag-title="BrowserSync - 浏览器同步测试工具">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>之前在学 gulp 的时候，使用 <code>gulp-livereload</code> 来实时自动刷新页面省时开发，但一直比较难用，现在找到新的替代神器。</p>
<h2 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用淘宝镜像会快些</span></div><div class="line">npm install -g browser-sync --registry=https:<span class="comment">//registry.npm.taobao.org</span></div></pre></td></tr></table></figure>
<h2 id="启动："><a href="#启动：" class="headerlink" title="启动："></a>启动：</h2><h4 id="（1）静态网页（服务器模式）"><a href="#（1）静态网页（服务器模式）" class="headerlink" title="（1）静态网页（服务器模式）"></a>（1）静态网页（服务器模式）</h4><p> 先进入项目目录，然后：</p>
 <figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// --files 路径是相对于运行该命令的项目（目录） </span></div><div class="line">browser-sync start --server --files <span class="string">"css/*.css, *.html"</span></div><div class="line"><span class="comment">// 如果你的文件层级比较深，您可以考虑使用 **（表示任意目录）匹配，任意目录下任意.css 或 .html文件。 </span></div><div class="line">browser-sync start --server --files <span class="string">"**/*.css, **/*.html"</span></div><div class="line"><span class="comment">// --监听整个项目</span></div><div class="line">browser-sync start --server --files <span class="string">"**"</span></div></pre></td></tr></table></figure>
<h4 id="（2）动态网页（代理模式）"><a href="#（2）动态网页（代理模式）" class="headerlink" title="（2）动态网页（代理模式）"></a>（2）动态网页（代理模式）</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 主机名可以是ip或域名</span></div><div class="line">browser-sync start --proxy <span class="string">"主机名"</span> <span class="string">"css/*.css"</span></div></pre></td></tr></table></figure>
<hr>
<h4 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h4><p><a href="http://www.browsersync.cn/" target="_blank" rel="external"> Browsersync 中文网 - 省时的浏览器同步测试工具</a> </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/01/MySQL( Navicat )运行 .sql 文件时报错：[Err] 2006 - MySQL server has gone away 的解决方法/" itemprop="url">
                  MySQL( Navicat )运行 .sql 文件时报错：[Err] 2006 - MySQL server has gone away 的解决方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-01T22:12:00+08:00" content="2016-06-01">
              2016-06-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/01/MySQL( Navicat )运行 .sql 文件时报错：[Err] 2006 - MySQL server has gone away 的解决方法/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/01/MySQL( Navicat )运行 .sql 文件时报错：[Err] 2006 - MySQL server has gone away 的解决方法/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/06/01/MySQL( Navicat )运行 .sql 文件时报错：[Err] 2006 - MySQL server has gone away 的解决方法/" class="leancloud_visitors" data-flag-title="MySQL( Navicat )运行 .sql 文件时报错：[Err] 2006 - MySQL server has gone away 的解决方法">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景："><a href="#背景：" class="headerlink" title="背景："></a>背景：</h2><p>今天导入一个数据量很大的 .sql 文件时，报错：</p>
<p><img src="http://img.blog.csdn.net/20150419155518477?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZGVmb25kcw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br><img src="http://images2015.cnblogs.com/blog/896608/201606/896608-20160601220554274-328464488.png" alt=""></p>
<h2 id="原因："><a href="#原因：" class="headerlink" title="原因："></a>原因：</h2><p>可能是 sql 语句过长，超过 mysql 通信缓存区最大长度。</p>
<h2 id="解决："><a href="#解决：" class="headerlink" title="解决："></a>解决：</h2><ol>
<li><p>编辑 MySQL 安装目录下的 my.ini，在最后添加以下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">max_allowed_packet=16M</div></pre></td></tr></table></figure>
</li>
<li><p>重启 MySQL 服务</p>
</li>
</ol>
<hr>
<h4 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h4><ul>
<li><a href="http://www.th7.cn/db/mysql/201504/101946.shtml" target="_blank" rel="external"> MySQL 数据批量恢复时 [Err] 2006 - MySQL server has gone away 错误的解决</a></li>
<li><a href="http://www.2cto.com/database/201409/338500.html" target="_blank" rel="external">#2006-MySQLserverhasgoneaway</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/22/响应式网页中，如何只用 CSS 实现 div 的高和宽保持固定比例/" itemprop="url">
                  响应式网页中，如何只用 CSS 实现 div 的高和宽保持固定比例
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-22T20:16:00+08:00" content="2016-05-22">
              2016-05-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/22/响应式网页中，如何只用 CSS 实现 div 的高和宽保持固定比例/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/22/响应式网页中，如何只用 CSS 实现 div 的高和宽保持固定比例/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/05/22/响应式网页中，如何只用 CSS 实现 div 的高和宽保持固定比例/" class="leancloud_visitors" data-flag-title="响应式网页中，如何只用 CSS 实现 div 的高和宽保持固定比例">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="引言："><a href="#引言：" class="headerlink" title="引言："></a>引言：</h2><p>如果 div 里是<code>&lt;img&gt;</code>，原生就支持。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">.item img &#123;</div><div class="line">    float: left;</div><div class="line">    margin:5%;</div><div class="line">    <span class="tag">&lt;<span class="name">!-</span> <span class="attr">keystone</span> <span class="attr">--</span>&gt;</span></div><div class="line">    width: 20%;</div><div class="line">    <span class="tag">&lt;<span class="name">!-</span> <span class="attr">end</span> <span class="attr">--</span>&gt;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/rg2uqjet/embedded/result,html,css/dark" frameborder="0" allowfullscreen></iframe>
<h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><h4 id="1-使用媒体查询"><a href="#1-使用媒体查询" class="headerlink" title="1.使用媒体查询"></a>1.使用<strong>媒体查询</strong></h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">@media only screen and (min-width: 100px) and (max-width: 640px) &#123;</div><div class="line">   div&#123;</div><div class="line">      width: 100px;</div><div class="line">      height: 100px;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line">@media only screen and (min-width: 641px) and (max-width: 789px) &#123;</div><div class="line">   div&#123;</div><div class="line">      width: 200px;</div><div class="line">      height: 200px;</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="2-利用-padding-bottom-是百分比值的话，参考的是父元素的-width-而不是-height"><a href="#2-利用-padding-bottom-是百分比值的话，参考的是父元素的-width-而不是-height" class="headerlink" title="2.利用 padding-bottom 是百分比值的话，参考的是父元素的 width 而不是 height"></a>2.利用 <strong>padding-bottom</strong> 是百分比值的话，参考的是父元素的 width 而不是 height</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">.item &#123;</div><div class="line">    float: left;</div><div class="line">    background-color: darkslategrey;</div><div class="line">    border: 1px solid black;</div><div class="line">    margin: 5%;</div><div class="line">    <span class="tag">&lt;<span class="name">!-</span> <span class="attr">keystone</span> <span class="attr">--</span>&gt;</span></div><div class="line">    width: 20%;</div><div class="line">    height: 0;</div><div class="line">    padding-bottom: 20%;</div><div class="line">    <span class="tag">&lt;<span class="name">!-</span> <span class="attr">end</span> <span class="attr">--</span>&gt;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/6bq6fL9r/embedded/result,html,css/dark" frameborder="0" allowfullscreen></iframe>
<h4 id="3-使用-vw-属性，他是参考整个-viewport（视窗）的宽度【vw、vh、vmin、vmax-是-css3-新属性，支持主流浏览器且-IE10-以上】"><a href="#3-使用-vw-属性，他是参考整个-viewport（视窗）的宽度【vw、vh、vmin、vmax-是-css3-新属性，支持主流浏览器且-IE10-以上】" class="headerlink" title="3.使用 vw 属性，他是参考整个 viewport（视窗）的宽度【vw、vh、vmin、vmax 是 css3 新属性，支持主流浏览器且 IE10 以上】"></a>3.使用 vw 属性，他是参考整个 viewport（视窗）的宽度【<strong>vw、vh、vmin、vmax</strong> 是 css3 新属性，支持主流浏览器且 IE10 以上】</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">item &#123;</div><div class="line">    float: left;</div><div class="line">    background-color: darkslategrey;</div><div class="line">    border: 1px solid black;</div><div class="line">    margin: 5%;</div><div class="line">    <span class="tag">&lt;<span class="name">!-</span> <span class="attr">keystone</span> <span class="attr">--</span>&gt;</span></div><div class="line">    width: 20vw;</div><div class="line">    height: 20vw;</div><div class="line">    <span class="tag">&lt;<span class="name">!-</span> <span class="attr">end</span> <span class="attr">--</span>&gt;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/ze7mbd4w/embedded/result,html,css/dark" frameborder="0" allowfullscreen></iframe>
<hr>
<h4 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h4><p><a href="https://www.zhihu.com/question/20983035" target="_blank" rel="external"> CSS 中 margin-top / bottom( padding-top/bottom ) 百分比为何以最近的块级祖先元素的宽度而不是高度作计算？</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://cn.gravatar.com/userimage/110826796/0f9e16e4ae0776f52a4fb70bf02a5832.jpg?size=200"
               alt="蒋成智" />
          <p class="site-author-name" itemprop="name">蒋成智</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">25</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/xjnotxj" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.douban.com/people/xjnotxj/" target="_blank" title="豆瓣">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  豆瓣
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/xjnotxj" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/xjnotxj/" target="_blank" title="博客园">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  博客园
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/users/d7b6cb158217/latest_articles" target="_blank" title="简书">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  简书
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">蒋成智</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"xjnotxj"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("uheKVt60RMVmWaf4J8Nbm862-gzGzoHsz", "EHNMdwpPcWyREbLjlRUBGMgG");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
